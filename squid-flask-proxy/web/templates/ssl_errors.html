{% extends "layout.html" %}

{% block title %}SSL Errors Â· Squid Flask Proxy{% endblock %}

{% block content %}
<h1 class="page-title">SSL Errors</h1>
<p class="page-subtitle">Aggregated TLS/SSL-related errors parsed from <span style="font-family: var(--mono);">cache.log</span>.</p>

<section class="card">
  <div class="card-header">
    <h2 class="card-title">Recent errors</h2>
    <span class="badge">{{ rows|length }} rows</span>
  </div>
  <div class="card-body">
    <table class="table">
      <thead>
        <tr>
          <th>Domain</th>
          <th>Category</th>
          <th>Reason</th>
          <th class="num">Count</th>
          <th class="num">Last seen</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
          <tr>
            <td style="font-family: var(--mono);">{{ r.domain if r.domain else '-' }}</td>
            <td style="font-family: var(--mono);">{{ r.category }}</td>
            <td>
              <div>{{ r.reason }}</div>
              <div class="small" style="margin-top: 6px; font-family: var(--mono);">{{ r.sample }}</div>
            </td>
            <td class="num">{{ r.count }}</td>
            <td class="num"><span class="small">{{ fmt_ts(r.last_seen) }}</span></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    {% if rows|length == 0 %}
      <div class="small">No SSL/TLS errors recorded yet.</div>
    {% endif %}

    <div class="small" style="margin-top: 10px;">
      Notes: This is best-effort pattern matching. Some client-side breakage (e.g., pinning errors in apps) may not appear here.
    </div>
  </div>
</section>

{% endblock %}
