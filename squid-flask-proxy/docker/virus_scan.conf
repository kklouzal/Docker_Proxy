# c-icap virus_scan configuration for squid-flask-proxy
# Loaded by /etc/c-icap/c-icap.conf

# Keep scanning focused.
# Note: this c-icap-modules build only recognizes a limited set of data types.
virus_scan.ScanFileTypes TEXT DATA BINARY

# Do not stream partial content before full scan completes
virus_scan.SendPercentData 0

# Fail-open on scanner/service errors (browsing continues)
virus_scan.PassOnError on

# Allow 204 responses (Squid supports it)
virus_scan.Allow204Responces on

# Max object size to scan
virus_scan.MaxObjectSize 128M

# Use clamd_mod's engine name
virus_scan.DefaultEngine clamd
