# c-icap virus_scan configuration for squid-flask-proxy
# Loaded by /etc/c-icap/c-icap.conf

# Keep scanning focused.
# Note: this c-icap-modules build only recognizes a limited set of data types.
virus_scan.ScanFileTypes TEXT DATA BINARY


# Do not stream partial content before full scan completes
virus_scan.SendPercentData 50

# Only start early-send for larger objects (keeps small responses fully scanned before delivery)
virus_scan.StartSendPercentDataAfter 50M

# Fail-open on scanner/service errors (browsing continues)
virus_scan.PassOnError on

# Allow 204 responses (Squid supports it)
virus_scan.Allow204Responces on

# Max object size to scan
virus_scan.MaxObjectSize 128M

# Select the default engine.
# NOTE: clamd_mod only registers its engine after it can connect to the clamd socket.
# For immediate c-icap startup, avoid forcing an engine name here; virus_scan will
# pick the first available engine once registered.
# virus_scan.DefaultEngine clamd
